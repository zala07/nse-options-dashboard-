<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NSE Option Chain Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: center; }
    th { background: #f2f2f2; }
    input { padding: 8px; width: 200px; }
    button { padding: 8px 12px; margin-left: 6px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>NSE Option Chain Dashboard</h1>
  <p>Enter stock symbol (e.g., <b>SBIN</b>, <b>RELIANCE</b>, <b>TCS</b>)</p>
  <input type="text" id="symbolInput" placeholder="Enter symbol..." />
  <button onclick="loadData()">Fetch Data</button>

  <table id="optionTable">
    <thead>
      <tr>
        <th>Strike Price</th>
        <th>CE OI</th>
        <th>CE Vol</th>
        <th>PE OI</th>
        <th>PE Vol</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadData() {
      const symbol = document.getElementById("symbolInput").value.trim();
      if (!symbol) return alert("Please enter a symbol");

      const res = await fetch(`/option-chain/${symbol}`);
      const data = await res.json();

      const tbody = document.querySelector("#optionTable tbody");
      tbody.innerHTML = "";

      if (data.error) {
        tbody.innerHTML = `<tr><td colspan="5">${data.error}</td></tr>`;
        return;
      }

      data.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.strikePrice}</td>
          <td>${row.CE?.openInterest || "-"}</td>
          <td>${row.CE?.totalTradedVolume || "-"}</td>
          <td>${row.PE?.openInterest || "-"}</td>
          <td>${row.PE?.totalTradedVolume || "-"}</td>
        `;
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>
